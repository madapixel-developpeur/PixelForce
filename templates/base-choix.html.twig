{% if  is_granted('ROLE_AGENT') and app.session.get('secteurId') %}
{% set fonctionnalites = authService.getAccessibleFonctionnalites(app.user, app.session.get('secteurId')) %}
{% endif %}
<!DOCTYPE html>
<html >
    <head>
        {% if app.environment == 'prod' %}
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-8PBBKR57JN"></script>
            <script type="text/javascript" src="{{ asset('assets/js/google_analytics.js') }}"></script>
        {% endif %}

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        {# <meta name="viewport" content="width=device-width, initial-scale=1"> #}
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimal-ui">
        <meta name="google-site-verification" content="O5bvNXZxdhGiT5VN5hPxisFh_XZeZCQr4aN4yoy0Ilk" />

        <title>{% block title %}PixelForce{% endblock %}</title>
        <link rel="stylesheet" href="/assets/fontawesome-free-6.0.0-web/css/all.css" />

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600" rel="stylesheet">
        
        <link rel="stylesheet"  href="{{ asset('assets/vuexy/vendors/css/vendors.min.css') }}">
        <link rel="stylesheet"  href="{{ asset('assets/vuexy/vendors/css/charts/apexcharts.css') }}">
        <link rel="stylesheet"  href="{{ asset('assets/vuexy/vendors/css/extensions/toastr.min.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ asset('assets/vuexy/vendors/css/forms/select/select2.min.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ asset('assets/vuexy/vendors/css/pickers/flatpickr/flatpickr.min.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ asset('assets/vuexy/css/plugins/forms/pickers/form-flat-pickr.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ asset('assets/vuexy/css/plugins/forms/form-validation.css') }}">
        
        <link rel="stylesheet" type="text/css" href="{{asset('assets/css/animations.css')}}">
        <link rel="stylesheet" type="text/css" href="{{asset('assets/css/style.css?date=202407101840')}}">
        <link rel="stylesheet" type="text/css" href="{{asset('app-assets/css/pages/app-invoice.css')}}">
        <link rel="stylesheet" type="text/css" href="{{asset('app-assets/css/pages/app-ecommerce.css')}}">
        <link rel="stylesheet" href="{{ asset('assets/css/sweetalert2/sweetalert2.min.css')}}">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabler-icons/1.35.0/iconfont/tabler-icons.min.css" integrity="sha512-tpsEzNMLQS7w9imFSjbEOHdZav3/aObSESAL1y5jyJDoICFF2YwEdAHOPdOr1t+h8hTzar0flphxR76pd0V1zQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="{{ asset('app-assets/css/chat/chat.css')}}">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js" integrity="sha512-KZmyTq3PLx9EZl0RHShHQuXtrvdJ+m35tuOiwlcZfs/rE7NZv29ygNA8SFCkMXTnYZQK2OX0Gm2qKGfvWEtRXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <!-- Calendly link widget begin -->
		<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
		<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
		<!-- Calendly link widget end -->


        {# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
        {% block stylesheets %}
            {# {{ encore_entry_link_tags('vuexy_apexcharts') }} #}
            {# {{ encore_entry_link_tags('vuexy_toastr') }} #}
            {{ encore_entry_link_tags('vuexy_bootstrap') }}
            {{ encore_entry_link_tags('vuexy_bootstrap_extended') }}
            {{ encore_entry_link_tags('vuexy_colors') }}
            {{ encore_entry_link_tags('vuexy_components') }}
            {{ encore_entry_link_tags('vuexy_dark_layout') }}
            {{ encore_entry_link_tags('vuexy_vertical_menu') }}
            {{ encore_entry_link_tags('vuexy_ext_component_toastr') }}

            {{ encore_entry_link_tags('app') }}
            {{ encore_entry_link_tags('base') }}
            {{ encore_entry_link_tags('chat') }}
        {% endblock %}

    </head>
    <body class="pace-done vertical-layout vertical-menu-modern navbar-floating footer-static menu-collapsed" data-open="click" data-menu="vertical-menu-modern" data-col="">
        <!-- Navbar -->
        {% include '/partials/header-navbar.html.twig' with {'hideMenu': true } %}

        <!-- Sidebar -->

        <!-- Content -->
        <div class="app-content content ">
            <div class="content-overlay"></div>
            <div class="header-navbar-shadow"></div>
            <div class="content-wrapper container-xxl p-0">
                <div class="content-header row">
                </div>
                <div class="content-body">
                    {# Affichage des messages flash #}
                    {% set excluded_flash_types = ['congratulation_message'] %}
                    {% set congratulation_message = app.flashes('congratulation_message') %}
                    {% for label, messages in app.flashes %}
                        {% for message in messages %}
                            <div id="msgFlash" class="alert alert-{{ label }} msgFlash mb-2 mt-4 mb-4">
                                {{ message | raw }}
                            </div>
                        {% endfor %}
                    {% endfor %}

                    {# Body component #}
                    {% block body %} {% endblock %}
                </div>
            </div>
        </div>

        <!-- Overlay -->
        <div class="sidenav-overlay"></div>
        <div class="drag-target"></div> 

        {% include 'live/video/liveVideoRapide.html.twig' %}
        {% include 'live/chat/mini_menu_chat.html.twig'  %}

        {% block chat %}
        {% include '/partials/chat/chat-widget.html.twig' %}
        {% endblock %}
        
        
        {% block javascripts %}
            <script type="application/json" id="live-call-topic">{{ mercure(constant('App\\Services\\LiveVideo::CALL_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json" id="live-refus-topic">{{ mercure(constant('App\\Services\\LiveVideo::REFUS_CALL_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json" id="chat-newMessage-topic">{{ mercure(constant('App\\Services\\Chat\\ChatMercureNotification::CHAT_ADD_MESSAGE_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json" id="chat-vu-topic">{{ mercure(constant('App\\Services\\Chat\\ChatMercureNotification::CHAT_ADD_VU_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json" id="chat-userTyping-topic">{{ mercure(constant('App\\Services\\Chat\\ChatMercureNotification::CHAT_USER_TYPING_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json" id="chat-userStopTyping-topic">{{ mercure(constant('App\\Services\\Chat\\ChatMercureNotification::CHAT_USER_STOP_TYPING_TOPIC')~(app.user.id|base64_encode))|json_encode(constant('JSON_UNESCAPED_SLASHES') b-or constant('JSON_HEX_TAG'))|raw }}</script>
            <script type="application/json"  id="current-user-id">{{ app.user.id }}</script>
            <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js"></script>
            <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
            <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
            <script src='https://meet.jit.si/external_api.js' id='meet-live-video'></script>
            <script src="{{ asset('assets/vuexy/vendors/js/vendors.min.js') }}" ></script>
            <script src="{{ asset('assets/vuexy/vendors/js/extensions/toastr.min.js') }}"></script>

            

            {# {{ encore_entry_script_tags('vuexy_calendar_fullcalendar') }} #}
            {# {{ encore_entry_script_tags('vuexy_extensions_moment') }} #}
            {# {{ encore_entry_script_tags('vuexy_forms_select_select2') }} #}
            {# {{ encore_entry_script_tags('vuexy_forms_validation_jquery_validate') }}
            {{ encore_entry_script_tags('vuexy_pickers_flatpickr') }} #}

            {{ encore_entry_script_tags('app') }}
            {{ encore_entry_script_tags('bootstrap_touchspin') }}
            {{ encore_entry_script_tags('vuexy_app_menu') }}
            {{ encore_entry_script_tags('vuexy_app') }}
            {{ encore_entry_script_tags('vuexyJS') }}
            {{ encore_entry_script_tags('chatJS')}}

            <script src="{{ asset('assets/bootstrap/js/bootstrap.js')}}" defer></script>
            <script src="{{ asset('assets/js/sweetallert.js')}}" defer></script>
            <script src="{{ asset('assets/js/confirmation.js')}}" defer></script>
            <script src="{{ asset('assets/vuexy/vendors/js/calendar/fullcalendar.min.js') }}"></script>
            <script src="{{ asset('assets/vuexy/vendors/js/extensions/moment.min.js') }}"></script>
            <script src="{{ asset('assets/vuexy/vendors/js/forms/select/select2.full.min.js') }}" defer></script>
            <script src="{{ asset('assets/vuexy/vendors/js/forms/validation/jquery.validate.min.js') }}" defer></script>
            <script src="{{ asset('assets/vuexy/vendors/js/pickers/flatpickr/flatpickr.min.js') }}" defer></script>
            <script  src="{{asset('assets/js/sweetalert2/sweetalert2.all.min.js')}}"></script>
            <script  src="{{asset('assets/js/sweetalert2/sweetalerts.js')}}"></script>
            
            {% for message in congratulation_message %}
                <script>
                    Swal.fire({ 
                        title: "Félicitation!",
                        text: "{{ message  | raw }}",
                        type: "success", 
                        confirmButtonClass: "btn btn-success", 
                        buttonsStyling: !1 
                    });
                </script>
            {% endfor %}
        
        {% endblock %}

        {% block chatScripts %}
            <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/moment-duration-format@2.3.2/lib/moment-duration-format.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js" integrity="sha512-luMnTJZ7oEchNDZAtQhgjomP1eZefnl82ruTH/3Oj/Yu5qYtwL7+dVRccACS/Snp1lFXq188XFipHKYE75IaQQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-socket-io/0.7.0/socket.min.js" integrity="sha512-RB0FN8aKxL1P9La/rZN27Jk6istGcQxfgipQGx1D+abcsdwpBnMeZnw8O3DfQvwerZ8VLie+UUdUgiYz0sgwvA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/locale/fr.min.js" integrity="sha512-RAt2+PIRwJiyjWpzvvhKAG2LEdPpQhTgWfbEkFDCo8wC4rFYh5GQzJBVIFDswwaEDEYX16GEE/4fpeDNr7OIZw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-i18n/1.8.3/angular-locale_fr-fr.min.js" integrity="sha512-MCAYlKrKtIZuB2/OgBy7GcuYJsqzD+SL3BtLi3S9Gqah2QRDz242o2T4nbmVu5TptihL3spl98VVMT2hAYODcg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script type="text/javascript">
                moment.locale('fr');
                window.momentDurationFormatSetup(moment);
                window.baseUrlChat = '{{base_url_chat}}';
                window.socketUrlChat = '{{socket_url_chat}}';
                window.jwtToken = '{{configSecteurService.getUserJwtToken(app.user)}}';
                window.userId = '{{app.user.id}}';
            </script>
            <script src="{{ asset('app-assets/js/chat/chat.js') }}"></script>
        {% endblock %}
    </body>
</html>
